\timing

-- cria banco ~pns~ para Pesquisa Nacional de Saúde (PNS/IBGE)
--drop database if exists pns;
--        create database pns;

-- conecta ao banco ~pns~
\c pns;

-- cria schema ~ed2019~ para a edição 2019 da PNS
          create schema ed2019;

-- dicionário de dados (explicação de colunas e respostas)
-- drop table if exists ed2019.datadict;
           create table ed2019.datadict (
                        var text,
                        enun text,
                        cod text,
                        resp text
                        );

-- importa dicionário de dados brutos na tabela ~datadict~
-- /pg_data/ existe dentro do docker do postgres!
copy ed2019.datadict from '/pg_data/pg_pns2019_vars' delimiter '|' csv; -- dados sem cabeçalho

-- microdados separados por variavel
--   drop table if exists ed2019.microdata;
           create table ed2019.microdata (
                        V0001 text,
                        V0024 text,
                        UPA_PNS text,
                        V0006_PNS text,
                        V0015 text,
                        V0020 text,
                        V0022 text,
                        V0026 text,
                        V0031 text,
                        V0025A text,
                        V0025B text,
                        A001 text,
                        A002010 text,
                        A003010 text,
                        A004010 text,
                        A01001 text,
                        A011 text,
                        A005010 text,
                        A005012 text,
                        A00601 text,
                        A009010 text,
                        A01401 text,
                        A01402 text,
                        A01403 text,
                        A01501 text,
                        A016010 text,
                        A018011 text,
                        A018012 text,
                        A018013 text,
                        A018014 text,
                        A018015 text,
                        A018016 text,
                        A018017 text,
                        A018018 text,
                        A018019 text,
                        A018020 text,
                        A018021 text,
                        A018022 text,
                        A018023 text,
                        A018024 text,
                        A018025 text,
                        A018026 text,
                        A018027 text,
                        A018028 text,
                        A01901 text,
                        A02101 text,
                        A02102 text,
                        A02201 text,
                        A02305 text,
                        A02306 text,
                        A02307 text,
                        A02308 text,
                        A02401 text,
                        A02402 text,
                        B001 text,
                        B002 text,
                        B003 text,
                        B004 text,
                        C001 text,
                        C00301 text,
                        C004 text,
                        C006 text,
                        C00701 text,
                        C00702 text,
                        C00703 text,
                        C008 text,
                        C009 text,
                        C01001 text,
                        C010010 text,
                        C013 text,
                        C014 text,
                        C015 text,
                        C016 text,
                        C017 text,
                        C018 text,
                        C01801 text,
                        C011 text,
                        C012 text,
                        D001 text,
                        D00201 text,
                        D00202 text,
                        D00301 text,
                        D00501 text,
                        D006 text,
                        D00601  text,
                        D007 text,
                        D008 text,
                        D00901 text,
                        D010 text,
                        D01101 text,
                        D01201 text,
                        D01301 text,
                        D01302 text,
                        D01303 text,
                        D014 text,
                        D015 text,
                        E001 text,
                        E002 text,
                        E003 text,
                        E004 text,
                        E005 text,
                        E006011 text,
                        E008 text,
                        E010010 text,
                        E010011 text,
                        E010012 text,
                        E010013 text,
                        E011 text,
                        E01201 text,
                        E01401 text,
                        E014011 text,
                        E01402 text,
                        E01403 text,
                        E01501 text,
                        E01601 text,
                        E01602 text,
                        E01603 text,
                        E01604 text,
                        E01605 text,
                        E017 text,
                        E01801 text,
                        E01802 text,
                        E01803 text,
                        E01804 text,
                        E01805 text,
                        E019 text,
                        E022 text,
                        E023011 text,
                        E024011 text,
                        E02402 text,
                        E024021 text,
                        E025 text,
                        E02501 text,
                        E02502 text,
                        E02503 text,
                        E026 text,
                        E02601 text,
                        E02801 text,
                        E02802 text,
                        E02803 text,
                        E02804 text,
                        E02805 text,
                        E02806 text,
                        E030 text,
                        E03101 text,
                        E03102 text,
                        E03103 text,
                        E03104 text,
                        E03105 text,
                        E03106 text,
                        E03107 text,
                        E03108 text,
                        E032 text,
                        E033 text,
                        E027 text,
                        F001011 text,
                        F001021 text,
                        F007011 text,
                        F007021 text,
                        F008011 text,
                        F008021 text,
                        VDF001 text,
                        VDF00102 text,
                        F016 text,
                        G033 text,
                        G034 text,
                        G035 text,
                        G036 text,
                        G038 text,
                        G039 text,
                        G040 text,
                        G041 text,
                        G042 text,
                        G044 text,
                        G046 text,
                        G047 text,
                        G048 text,
                        G049 text,
                        G050 text,
                        G051 text,
                        G052 text,
                        G053 text,
                        G054 text,
                        G055 text,
                        G057 text,
                        G058 text,
                        G05801 text,
                        G059 text,
                        G060 text,
                        G061 text,
                        G062 text,
                        G063 text,
                        G064 text,
                        G065 text,
                        G066 text,
                        G067 text,
                        G068 text,
                        G070 text,
                        G071 text,
                        G072 text,
                        G073 text,
                        G074 text,
                        G075 text,
                        G076 text,
                        G077 text,
                        G079 text,
                        G080 text,
                        G081 text,
                        G082 text,
                        G083 text,
                        G084 text,
                        G085 text,
                        G086 text,
                        G032 text,
                        I00101 text,
                        I00102 text,
                        I001021 text,
                        I00103 text,
                        I001031 text,
                        I005 text,
                        I006 text,
                        I004 text,
                        I00401 text,
                        I00402 text,
                        I00403 text,
                        I00404 text,
                        I010010 text,
                        I012 text,
                        J001 text,
                        J00101 text,
                        J002 text,
                        J003 text,
                        J00402 text,
                        J00404 text,
                        J005 text,
                        J006 text,
                        J007 text,
                        J00801 text,
                        J009 text,
                        J01002 text,
                        J01101 text,
                        J012 text,
                        J01301 text,
                        J014 text,
                        J01502 text,
                        J01602 text,
                        J01701 text,
                        J01802 text,
                        J019 text,
                        J02002 text,
                        J021 text,
                        J022010 text,
                        J023 text,
                        J024 text,
                        J025 text,
                        J026 text,
                        J02702 text,
                        J02901 text,
                        J03001 text,
                        J03102 text,
                        J032 text,
                        J03301 text,
                        J034 text,
                        J035 text,
                        J03602 text,
                        J037 text,
                        J038 text,
                        J039 text,
                        J04001 text,
                        J04002 text,
                        J041 text,
                        J042 text,
                        J043 text,
                        J044 text,
                        J046 text,
                        J047 text,
                        J048 text,
                        J049 text,
                        J051 text,
                        J052 text,
                        J05301 text,
                        J05402 text,
                        J05403 text,
                        J05404 text,
                        J05405 text,
                        J05406 text,
                        J05407 text,
                        J05408 text,
                        J05409 text,
                        J054010 text,
                        J056 text,
                        J057 text,
                        J060 text,
                        K001 text,
                        K004 text,
                        K007 text,
                        K010 text,
                        K013 text,
                        K016 text,
                        K019 text,
                        K01901 text,
                        K02001 text,
                        K02101 text,
                        K02102 text,
                        K022 text,
                        K025 text,
                        K028 text,
                        K031 text,
                        K034 text,
                        K03401 text,
                        K03501 text,
                        K03601 text,
                        K03602 text,
                        K04301 text,
                        K04302 text,
                        K04401 text,
                        K045 text,
                        K046 text,
                        K047 text,
                        K048 text,
                        K050 text,
                        K051 text,
                        K052 text,
                        K05302 text,
                        K05401 text,
                        K05402 text,
                        K055 text,
                        K05601 text,
                        K05602 text,
                        K062 text,
                        L01701 text,
                        L01702 text,
                        L01703 text,
                        L01704 text,
                        L01705 text,
                        L01706 text,
                        L01707 text,
                        L01708 text,
                        L01709 text,
                        L01710 text,
                        L01711 text,
                        L01712 text,
                        L01713 text,
                        L01714 text,
                        L01715 text,
                        L01716 text,
                        L018 text,
                        L019 text,
                        L021 text,
                        L022 text,
                        L023 text,
                        L024 text,
                        L025 text,
                        L026 text,
                        L027 text,
                        L028 text,
                        L029 text,
                        L030 text,
                        L031 text,
                        L032 text,
                        L033 text,
                        L034 text,
                        L035 text,
                        L036 text,
                        L037 text,
                        L038 text,
                        L039 text,
                        L040 text,
                        L042 text,
                        M001 text,
                        M002 text,
                        M00203 text,
                        M00302 text,
                        M00303 text,
                        M00401 text,
                        M00402 text,
                        M005010 text,
                        M005011 text,
                        M00601 text,
                        M007 text,
                        M008 text,
                        M009 text,
                        M01001 text,
                        M011011 text,
                        M011021 text,
                        M011031 text,
                        M011041 text,
                        M011051 text,
                        M011061 text,
                        M011071 text,
                        M01401 text,
                        M01501 text,
                        M01601 text,
                        M01701 text,
                        M01801 text,
                        M01901 text,
                        N001 text,
                        N00101 text,
                        N004 text,
                        N005 text,
                        N006 text,
                        N00701 text,
                        N008 text,
                        N010 text,
                        N011 text,
                        N012 text,
                        N013 text,
                        N014 text,
                        N015 text,
                        N016 text,
                        N017 text,
                        N018 text,
                        O00101 text,
                        O00401 text,
                        O00402 text,
                        O00501 text,
                        O00201 text,
                        O00701 text,
                        O00801 text,
                        O00802 text,
                        O00803 text,
                        O009 text,
                        O00901 text,
                        O010 text,
                        O01102 text,
                        O01401 text,
                        O01501 text,
                        O01602 text,
                        O01702 text,
                        O019 text,
                        O02001 text,
                        O021 text,
                        O02101 text,
                        O02201 text,
                        O023 text,
                        O02401 text,
                        P00102 text,
                        P00103 text,
                        P00104 text,
                        P00201 text,
                        P00402 text,
                        P00403 text,
                        P00404 text,
                        P00405 text,
                        P005 text,
                        P00601 text,
                        P00602 text,
                        P00603 text,
                        P00604 text,
                        P00605 text,
                        P00607 text,
                        P00608 text,
                        P00609 text,
                        P00610 text,
                        P00611 text,
                        P00612 text,
                        P00613 text,
                        P00614 text,
                        P00615 text,
                        P00616 text,
                        P00617 text,
                        P00618 text,
                        P00619 text,
                        P00620 text,
                        P00621 text,
                        P00622 text,
                        P00623 text,
                        P006 text,
                        P00901 text,
                        P01001 text,
                        P01101 text,
                        P013 text,
                        P015 text,
                        P02001 text,
                        P02101 text,
                        P01601 text,
                        P018 text,
                        P019 text,
                        P02002 text,
                        P02102 text,
                        P023 text,
                        P02401 text,
                        P02501 text,
                        P02602 text,
                        P02601 text,
                        P027 text,
                        P02801 text,
                        P029 text,
                        P03201 text,
                        P03202 text,
                        P03001 text,
                        P03301 text,
                        P03302 text,
                        P03303 text,
                        P034 text,
                        P035 text,
                        P03701 text,
                        P03702 text,
                        P036 text,
                        P038 text,
                        P039 text,
                        P03904 text,
                        P03905 text,
                        P03906 text,
                        P040 text,
                        P04001 text,
                        P04101 text,
                        P04102 text,
                        P042 text,
                        P04301 text,
                        P04302 text,
                        P044 text,
                        P04401 text,
                        P04405 text,
                        P04406 text,
                        P04501 text,
                        P04502 text,
                        P046 text,
                        P04701 text,
                        P04801 text,
                        P04902 text,
                        P050 text,
                        P051 text,
                        P052 text,
                        P053 text,
                        P05401 text,
                        P05402 text,
                        P05403 text,
                        P05404 text,
                        P05405 text,
                        P05406 text,
                        P05407 text,
                        P05408 text,
                        P05409 text,
                        P05410 text,
                        P05411 text,
                        P05412 text,
                        P05413 text,
                        P05414 text,
                        P05415 text,
                        P05416 text,
                        P05417 text,
                        P05418 text,
                        P05419 text,
                        P05421 text,
                        P05422 text,
                        P055 text,
                        P056 text,
                        P05601 text,
                        P05602 text,
                        P05603 text,
                        P05604 text,
                        P05605 text,
                        P057 text,
                        P058 text,
                        P05801 text,
                        P05802 text,
                        P05901 text,
                        P05902 text,
                        P05903 text,
                        P05904 text,
                        P05905 text,
                        P05906 text,
                        P060 text,
                        P06101 text,
                        P06102 text,
                        P06103 text,
                        P06104 text,
                        P06105 text,
                        P06106 text,
                        P06302 text,
                        P067 text,
                        P06701 text,
                        P068 text,
                        P069 text,
                        P06901 text,
                        P07004 text,
                        P07005 text,
                        P07006 text,
                        P07007 text,
                        P07101 text,
                        P07201 text,
                        Q00101 text,
                        Q00201 text,
                        Q00202 text,
                        Q003 text,
                        Q00401 text,
                        Q00502 text,
                        Q00503 text,
                        Q00601 text,
                        Q00602 text,
                        Q00801 text,
                        Q009 text,
                        Q010 text,
                        Q01101 text,
                        Q01202 text,
                        Q014 text,
                        Q015 text,
                        Q016 text,
                        Q017 text,
                        Q018010 text,
                        Q018011 text,
                        Q018012 text,
                        Q018013 text,
                        Q018014 text,
                        Q018015 text,
                        Q018016 text,
                        Q018017 text,
                        Q01910 text,
                        Q019101 text,
                        Q01911 text,
                        Q019111 text,
                        Q01912 text,
                        Q019121 text,
                        Q01913 text,
                        Q019131 text,
                        Q022 text,
                        Q02301 text,
                        Q026 text,
                        Q02701 text,
                        Q028 text,
                        Q02901 text,
                        Q03001 text,
                        Q03002 text,
                        Q031 text,
                        Q03201 text,
                        Q03302 text,
                        Q03303 text,
                        Q03403 text,
                        Q03404 text,
                        Q03601 text,
                        Q03701 text,
                        Q03801 text,
                        Q03802 text,
                        Q03803 text,
                        Q03804 text,
                        Q03805 text,
                        Q03806 text,
                        Q03807 text,
                        Q03901 text,
                        Q04002 text,
                        Q042 text,
                        Q043 text,
                        Q044 text,
                        Q045 text,
                        Q046011 text,
                        Q046012 text,
                        Q046013 text,
                        Q046014 text,
                        Q046015 text,
                        Q046016 text,
                        Q046017 text,
                        Q046018 text,
                        Q046019 text,
                        Q046020 text,
                        Q046021 text,
                        Q04707 text,
                        Q047071 text,
                        Q04708 text,
                        Q047081 text,
                        Q04709 text,
                        Q047091 text,
                        Q04710 text,
                        Q047101 text,
                        Q04711 text,
                        Q047111 text,
                        Q050 text,
                        Q05101 text,
                        Q05301 text,
                        Q05401 text,
                        Q055011 text,
                        Q055012 text,
                        Q055013 text,
                        Q055014 text,
                        Q055015 text,
                        Q055016 text,
                        Q056 text,
                        Q05701 text,
                        Q058 text,
                        Q05901 text,
                        Q060 text,
                        Q061 text,
                        Q06207 text,
                        Q06208 text,
                        Q06209 text,
                        Q06210 text,
                        Q06211 text,
                        Q06212 text,
                        Q06306 text,
                        Q06307 text,
                        Q06308 text,
                        Q06309 text,
                        Q06310 text,
                        Q06311 text,
                        Q064 text,
                        Q06506 text,
                        Q06507 text,
                        Q06508 text,
                        Q06509 text,
                        Q06601 text,
                        Q067 text,
                        Q068 text,
                        Q070 text,
                        Q07208 text,
                        Q07209 text,
                        Q07210 text,
                        Q07211 text,
                        Q07212 text,
                        Q07213 text,
                        Q073 text,
                        Q074 text,
                        Q075 text,
                        Q076 text,
                        Q07601 text,
                        Q07704 text,
                        Q07705 text,
                        Q07706 text,
                        Q07707 text,
                        Q07708 text,
                        Q07709 text,
                        Q07710 text,
                        Q07711 text,
                        Q078 text,
                        Q079 text,
                        Q080 text,
                        Q08107 text,
                        Q08108 text,
                        Q08109 text,
                        Q08110 text,
                        Q08111 text,
                        Q082 text,
                        Q083 text,
                        Q084 text,
                        Q085 text,
                        Q08607 text,
                        Q08608 text,
                        Q08609 text,
                        Q08610 text,
                        Q08611 text,
                        Q087 text,
                        Q088 text,
                        Q08901 text,
                        Q09007 text,
                        Q09008 text,
                        Q09009 text,
                        Q09010 text,
                        Q09011 text,
                        Q091 text,
                        Q092 text,
                        Q09201 text,
                        Q09202 text,
                        Q09301 text,
                        Q094 text,
                        Q09502 text,
                        Q09605 text,
                        Q09606 text,
                        Q09607 text,
                        Q098 text,
                        Q100 text,
                        Q10101 text,
                        Q10202 text,
                        Q104 text,
                        Q105 text,
                        Q106 text,
                        Q10701 text,
                        Q109 text,
                        Q11006 text,
                        Q11007 text,
                        Q11008 text,
                        Q11009 text,
                        Q11010 text,
                        Q111 text,
                        Q11201 text,
                        Q11405 text,
                        Q11406 text,
                        Q11407 text,
                        Q11408 text,
                        Q115 text,
                        Q11604 text,
                        Q11605 text,
                        Q11606 text,
                        Q11607 text,
                        Q11701 text,
                        Q11806 text,
                        Q11807 text,
                        Q11808 text,
                        Q11809 text,
                        Q119 text,
                        Q120 text,
                        Q12102 text,
                        Q12103 text,
                        Q12104 text,
                        Q12105 text,
                        Q12106 text,
                        Q12107 text,
                        Q12108 text,
                        Q12109 text,
                        Q121010 text,
                        Q121011 text,
                        Q121012 text,
                        Q121013 text,
                        Q121014 text,
                        Q121015 text,
                        Q121016 text,
                        Q12201 text,
                        Q12301 text,
                        Q124 text,
                        Q125 text,
                        Q12501 text,
                        Q12607 text,
                        Q12608 text,
                        Q12609 text,
                        Q12610 text,
                        Q127 text,
                        Q128 text,
                        Q132 text,
                        Q133 text,
                        Q134 text,
                        R00101 text,
                        R002010 text,
                        R004 text,
                        R005 text,
                        R00601 text,
                        R007 text,
                        R008 text,
                        R009010 text,
                        R010 text,
                        R011 text,
                        R012 text,
                        R013 text,
                        R014 text,
                        R015 text,
                        R01701 text,
                        R019 text,
                        R020 text,
                        R02101 text,
                        R022 text,
                        R023 text,
                        R02402 text,
                        R025 text,
                        R026 text,
                        R027 text,
                        R028 text,
                        R029 text,
                        R030 text,
                        R031 text,
                        R032 text,
                        R033 text,
                        R034 text,
                        R035 text,
                        R03601 text,
                        R03602 text,
                        R03603 text,
                        R03604 text,
                        R03605 text,
                        R03606 text,
                        R03607 text,
                        R03608 text,
                        R03609 text,
                        R03610 text,
                        R03611 text,
                        R037 text,
                        R038 text,
                        S065 text,
                        S066 text,
                        S06701 text,
                        S06702 text,
                        S06703 text,
                        S068 text,
                        S06901 text,
                        S06902 text,
                        S070 text,
                        S071 text,
                        S072 text,
                        S073 text,
                        S074 text,
                        S075 text,
                        S076 text,
                        S077 text,
                        S07901 text,
                        S07902 text,
                        S07903 text,
                        S07904 text,
                        S07905 text,
                        S080 text,
                        S081 text,
                        S082 text,
                        S083 text,
                        S084 text,
                        S085 text,
                        S086 text,
                        S087 text,
                        S088 text,
                        S089 text,
                        S090 text,
                        S091 text,
                        S092 text,
                        S095 text,
                        S096 text,
                        S097 text,
                        S098 text,
                        S099 text,
                        S09901 text,
                        S109 text,
                        S110 text,
                        S11001 text,
                        S111 text,
                        S112 text,
                        S113 text,
                        S114 text,
                        S115 text,
                        S116 text,
                        S117 text,
                        S118 text,
                        S11801 text,
                        S119 text,
                        S120 text,
                        S121 text,
                        S122 text,
                        S123 text,
                        S124 text,
                        S125 text,
                        S126 text,
                        S127 text,
                        S128 text,
                        S129 text,
                        S130 text,
                        S131 text,
                        S132 text,
                        S133 text,
                        S134 text,
                        S135 text,
                        S136 text,
                        S137 text,
                        S138 text,
                        S139 text,
                        U00204 text,
                        U00205 text,
                        U00206 text,
                        U00207 text,
                        U00208 text,
                        U00101 text,
                        U00401 text,
                        U005 text,
                        U006 text,
                        U00902 text,
                        U01002 text,
                        U014 text,
                        U02001 text,
                        U02101 text,
                        U02302 text,
                        U02303 text,
                        U02402 text,
                        U02403 text,
                        U02501 text,
                        Z001 text,
                        Z00101 text,
                        Z00102 text,
                        Z002 text,
                        Z003 text,
                        Z004 text,
                        Z005 text,
                        Z006 text,
                        Z007 text,
                        Z008 text,
                        Z009 text,
                        Z010 text,
                        Z011 text,
                        Z012 text,
                        Z013 text,
                        Z01401 text,
                        Z01402 text,
                        V001 text,
                        V00101 text,
                        V00201 text,
                        V00202 text,
                        V00203 text,
                        V00204 text,
                        V00205 text,
                        V003 text,
                        V006 text,
                        V007 text,
                        V01401 text,
                        V01402 text,
                        V01403 text,
                        V01404 text,
                        V01405 text,
                        V015 text,
                        V018 text,
                        V019 text,
                        V02701 text,
                        V02702 text,
                        V02801 text,
                        V02802 text,
                        V029 text,
                        V032 text,
                        V033 text,
                        V034 text,
                        V03501 text,
                        V03502 text,
                        V03503 text,
                        V036 text,
                        V037 text,
                        V038 text,
                        V039 text,
                        T001 text,
                        T002 text,
                        T003 text,
                        T004 text,
                        T005 text,
                        T00601 text,
                        T00602 text,
                        T00603 text,
                        T00604 text,
                        T00605 text,
                        T00606 text,
                        Y001 text,
                        Y00101 text,
                        Y002 text,
                        Y003 text,
                        Y004 text,
                        Y005 text,
                        Y006 text,
                        Y007 text,
                        Y008 text,
                        H001 text,
                        H002 text,
                        H003 text,
                        H004 text,
                        H005 text,
                        H006 text,
                        H007 text,
                        H008 text,
                        H009 text,
                        H010 text,
                        H011 text,
                        H012 text,
                        H013 text,
                        H014 text,
                        H015 text,
                        H016 text,
                        H017 text,
                        H018 text,
                        H019 text,
                        H020 text,
                        H021 text,
                        H022 text,
                        H023 text,
                        H024 text,
                        H025 text,
                        H026 text,
                        H027 text,
                        H028 text,
                        H029 text,
                        H030 text,
                        W001 text,
                        W00101 text,
                        W00102 text,
                        W00103 text,
                        W00201 text,
                        W00202 text,
                        W00203 text,
                        V0028 text,
                        V0029 text,
                        V0030 text,
                        V00281 text,
                        V00291 text,
                        V00301 text,
                        V00282 text,
                        V00292 text,
                        V00302 text,
                        V00283 text,
                        V00293 text,
                        V00303 text,
                        VDC001 text,
                        VDC003 text,
                        VDD004A text,
                        VDE001 text,
                        VDE002 text,
                        VDE014 text,
                        VDF002 text,
                        VDF003 text,
                        VDF004 text,
                        VDL001 text,
                        VDM001 text,
                        VDP001 text,
                        VDR001 text,
                        VDDATA text
                        );

-- importa microdados brutos na tabela microdata
copy ed2019.microdata from '/pg_data/pg_pns2019_microdata.csv' delimiter '|' csv; -- microdados sem cabeçalho

